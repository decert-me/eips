---
eip: 2014
title: 扩展状态预言机
author: Alex Beregszaszi (@axic)
discussions-to: https://ethereum-magicians.org/t/eip-2014-extended-state-oracle/3301
status: 停滞
type: 标准跟踪
category: 核心
created: 2019-05-10
requires: 140
---

## 简单总结

## 摘要

引入一个新的系统合约，具有可扩展的接口，遵循 [合约 ABI 编码] 以访问扩展数据集，例如链标识符、区块哈希等。

这使得以太坊合约语言可以像与普通合约交互一样与该合约交互，而无需任何语言支持。

## 动机

在过去的几年中，提出了几个扩展 EVM 以获取更多数据的提案。一些例子包括对区块哈希的扩展访问 ([EIP-210]) 和链标识符 ([EIP-1344])。

将它们作为 EVM 操作码添加似乎是在相对不常用的功能上使用稀缺的操作码空间，而将它们作为预编译添加则被认为更复杂，因为每种情况都需要定义和达成一致的接口。

该提案试图通过定义一个可扩展的标准接口来解决这两个问题。

## 规范

在地址 `0x0000000000000000000000000000000000000009` 引入一个新的系统合约（“预编译”），称为 ESO（扩展状态预言机）。

可以使用 `CALL` 或 `STATICCALL` 查询它，并遵循 [合约 ABI 编码] 的输入和输出。建议在 ABI 编码中使用基本类型，以保持复杂性低。

未来可能会扩展 ESO 以具有状态并接受来自系统地址的交易以存储传递的数据——类似于 [EIP-210] 提出的内容。

希望将更多数据引入状态的提案，应该旨在扩展 ESO。

目前并不提议将 ESO 制作成存在于状态中的合约，而是将其作为预编译包含，并将实现细节留给客户端。
未来如果它得到充分扩展并且出现需要具有状态的需求，将其从预编译转移并拥有实际代码是有意义的。

### 链标识符

最初，引入一个读取当前链标识符的功能：`getCurrentChainId()` 返回当前链标识符作为 `uint64` 编码值。
这应该是一个不可支付的函数，这意味着发送任何值都会使交易回滚，如 [EIP-140] 所述。
这已被提议为 [EIP-1344]。

合约 ABI JSON 如下：
```json
[
    {
	"constant": true,
	"inputs": [],
	"name": "getCurrentChainId",
	"outputs": [
	    {
		"name": "",
		"type": "uint64"
	    }
	],
	"payable": false,
	"stateMutability": "pure",
	"type": "function"
    }
]
```

这将被转换为向 ESO 发送字节 `5cf0e8a4` 并返回字节 `0000000000000000000000000000000000000000000000000000000000000001` 以用于以太坊主网。

**注意：** 应该可以引入另一个接口，以检查链历史中链标识符的有效性或针对给定区块的有效性（参见 [EIP-1959] 和 [EIP-1965]）。

## 理由

待定

## 向后兼容性

待定

## 测试用例

待定

## 实现

待定

## 版权
版权及相关权利通过 [CC0](../LICENSE.md) 放弃。

[合约 ABI 编码]: https://solidity.readthedocs.io/en/latest/abi-spec.html
[EIP-140]: ./eip-140.md
[EIP-210]: ./eip-210.md
[EIP-1344]: ./eip-1344.md
[EIP-1959]: https://github.com/ethereum/EIPs/pull/1959
[EIP-1965]: https://github.com/ethereum/EIPs/pull/1965