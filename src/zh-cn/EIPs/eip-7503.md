---
eip: 7503
title: 零知识虫洞
description: 使秘密销毁的以太币能够作为以太坊的原生隐私解决方案进行铸造
author: Keyvan Kambakhsh (@keyvank), Hamid Bateni (@irnb), Amir Kahoori <a.kahoorizadeh@gmail.com>, Nobitex Labs <labs@nobitex.ir>
discussions-to: https://ethereum-magicians.org/t/eip-7503-zero-knowledge-wormholes-private-proof-of-burn-ppob/15456
status: Stagnant
type: Standards Track
category: Core
created: 2023-08-14
---

## 摘要

在研究隐私解决方案和零知识证明的应用时，我们发现了一种技术，通过该技术，人们可以通过将其数字资产（例如以太币）发送到不可支出的地址来销毁它，并随后构建一个零知识证明，显示某些代币的数量存在于一个不可支出的账户中，而不透露该账户。

该 EIP 提议为以太坊添加铸造功能，以便人们可以重新铸造他们故意销毁的以太币。上述隐私解决方案将为发送者带来强大的*合理否认*能力，因为没有办法证明发送者参与了隐私协议。这还将创建一个匿名池，默认情况下包括所有没有外部交易的以太坊账户。

## 规范

在基于椭圆曲线的数字签名中，通常存在一个秘密标量$s$，从中计算出公钥（通过将生成点与标量相乘：$s \times G$）。以太坊 EOA 地址是公钥的 keccak 哈希。

此外，如果智能合约的参数的 keccak 哈希等于该地址，则以太坊地址中的资金可能由智能合约支出。

因此，以太坊地址$A$仅在以下情况下可支出：

 1. 存在一个私钥$s$，使得$A = keccak(s \times G)$。
 2. 存在一个智能合约$c$，使得$A = keccak(c_{params})$。

哈希函数的前像抗性属性意味着，你无法找到$x$使得$keccak(x)=r$，如果$r$是一个随机值。因此，发送到随机以太坊地址$r$的资金是不可支出的，但其他人如何确保$r$确实是随机的，而不是计算$s \times G$的结果呢？

一个很好的随机源是哈希函数。如果地址等于秘密前像$s$的哈希，我们可以得出结论，该地址是不可支出的，因为没有多项式有界算法可以找到$x$使得$keccak(x)=h(s)$。这仅在第二个哈希函数是不同的哈希函数时成立，并假设不可能找到$x_1$和$x_2$使得$h_1(x_1)=h_2(x_2)$，如果$h_1$和$h_2$是不同的哈希函数。

借助零知识证明，我们可以隐藏$s$的值！我们只需要证明我们知道一个秘密值$s$，使得地址是$h(s)$。我们甚至可以更进一步。我们可以证明在状态根中存在一个以太坊账户，该账户持有一定数量的以太币并且是不可支出的。

通过向以太坊区块链揭示这一点并提供类似于无效标识符（例如$h(s | 123)$，以便防止相同销毁代币的双重铸造），我们可以为以太币添加新的*铸造*功能，以便人们可以将他们秘密销毁的代币迁移到一个全新的地址，而在区块链上没有任何痕迹。目标地址也可以是销毁地址，将重新铸造的资金保留在匿名池中。

## 理由

像 TornadoCash 这样的加密货币混合器可以成功地模糊以太坊交易，但政府很容易禁止使用它们。任何与混合器合约有交互的人，无论是发送者还是接收者，都可能被标记。然而，该 EIP 试图通过要求在发送资金时不进行智能合约交互来最小化发送者的隐私泄漏，因此我们只使用普通的 EOA 到 EOA 转账。为了实现“传送”机制，我们将所有 Secp256k1 点$E(K)$的集合划分为两个子集/地址空间：

 - 可支出地址空间：$\\{p \in \\{0,1\\}^{160} | \exists s : keccak(s \times G)=p \lor \exists c : keccak(c_{params})=p \\}$
 - 不可支出地址空间：$\\{p \in \\{0,1\\}^{160} | \nexists s : keccak(s \times G)=p \land \nexists c : keccak(c_{params})=p \\}$

可支出/不可支出地址是不可区分的，因此我们可以利用这一事实，为发送到无法通过常规椭圆曲线签名支出的地址的资金定义一个可支出规则。借助零知识证明，我们可以隐藏交易痕迹并设计一个新的隐私协议，这正是该 EIP 所提议的。

### 可扩展性影响

如果电路能够在单个证明中同时重新铸造多个销毁的总和，商家和中心化交易所将能够接受他们在销毁地址上的支付，并通过在区块链上存储单个证明（以及一堆无效标识符）来累积他们的资金，这将显著减少区块链上的交易数量。使用该 EIP 作为可扩展性解决方案的人们，也将增加协议的隐私保证。

## 向后兼容性

使用铸造功能生成的以太币与原始以太币之间不应有任何差异。人们应该能够使用这些铸造的以太币支付 gas 费用。

## 参考实现

参考实现尚未准备好，但这里有一个设计：

- 我们需要跟踪区块链上发生的所有以太币转账（包括由智能合约发起的转账），并将它们添加到一个 ZK 友好的稀疏默克尔树中。发送的金额也应包含在叶子中。
- 我们需要一种新的交易类型，负责铸造以太币。发起者应提供一个证明（以及一个无效标识符），证明他拥有默克尔树中具有特定数量以太币的叶子。

或者，我们可以使用已经维护的状态树，并提供默克尔-帕特里夏树证明，显示在不可支出的账户中存在一定数量的以太币，并铸造它们。

## 安全考虑

如果该 EIP 的实现存在缺陷，人们可能会铸造无限数量的以太币，从而导致以太坊价格崩溃。

## 版权

通过 [CC0](../LICENSE.md) 放弃版权及相关权利。