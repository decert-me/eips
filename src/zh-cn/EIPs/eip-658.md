---
eip: 658
title: 在收据中嵌入交易状态码
author: Nick Johnson <nick@ethereum.org>
type: 标准跟踪
category: 核心
status: 最终
created: 2017-06-30
requires: 140
---

## 摘要
本 EIP 用状态码替换收据中的中间状态根字段，以指示顶层调用是成功还是失败。

## 动机
随着 EIP140 中 REVERT 操作码的引入，用户不再能够假设交易失败仅仅是因为消耗了所有的 gas。因此，调用者没有明确的机制来确定交易是否成功，以及其中的状态变化是否已被应用。

完整节点可以通过重放交易提供 RPC 来获取交易返回状态和数值，但快速节点只能在其支点之后对节点执行此操作，而轻节点根本无法做到这一点，这使得非共识解决方案变得不切实际。

相反，我们建议用返回状态（成功为 1，失败为 0）替换已经被 EIP98 废弃的中间状态根。这不仅允许调用者确定成功状态，还弥补了收据中返回数据缺失的前一个遗漏。

## 规范
对于块号大于等于 BYZANTIUM_FORK_BLKNUM 的区块，中间状态根被状态码替换，0 表示失败（由于任何可能导致交易或顶层调用回退的操作），1 表示成功。

## 理由
这构成了一个最小的可能更改，允许获取交易的成功/失败状态，保持现有功能，最小化对 Metropolis 的干扰或额外工作。

## 版权
版权及相关权利通过 [CC0](../LICENSE.md) 放弃。