---
eip: 698
title: OPCODE 0x46 BLOCKREWARD
author: Cody Burns <dontPanic@codywburns.com>
discussions-to: https://github.com/ethereum/EIPs/issues/698
status: Stagnant
type: Standards Track
category: Core
created: 2017-08-28
---

## 简单总结

此 EIP 向 EVM 添加了一个额外的操作码，用于返回已最终确定区块的奖励值。

## 摘要

在 EVM 中，0x40 操作码保留用于 `区块信息`。当前保留的操作码有：
* `0X40 BLOCKHASH`
* `0X41 COINBASE`
* `0X42 TIMESTAMP`
* `0X43 NUMBER`
* `0X44 DIFFICULTY`
* `0X45 GASLIMIT`

此 EIP 将添加一个额外的操作码 `0x46 BLOCKREWARD`，该操作码将返回任何已最终确定区块的区块奖励。最终确定的区块奖励将包括基本奖励、叔块支付和 gas。

## 动机

根据 EIP-649（#669），现在计划在路线图中进行定期的区块奖励减少/变动，然而，此 EIP 与共识系统无关，最适用于去中心化池操作以及任何需要知道区块奖励支付的合约（即合并挖矿代币）。

## 规范

在区块 `n` 之后，所有客户端应按如下方式处理操作码 `0x46`：

* 值：`0x46`
* 助记符：`BLOCKREWARD`
* δ：`0` 从栈中没有移除任何内容
* α：`1` 区块奖励添加到栈中
* 描述：`获取区块的奖励发放`
* GasCost：`G<sub>base</sub>`

其中：`µ'<sub>s</sub>[0] ≡ I<sub>HR</sub>`

## 理由

### 合约挖矿池

对于分布式共识系统（质押池和挖矿池），临时小组结合资源以减少支付的变动。广义上，池操作通过允许一群矿工/质押者验证他们在解决 PoW 或质押份额中的贡献，定期提交代表矿工找到真实区块概率的解决方案来运作。

在所有这些方案中，`B` 代表区块奖励减去池费，`p` 是在一次份额尝试中找到区块的概率（`p=1/D`，其中 `D` 是当前区块难度）。

一些常见的挖矿池支付方法包括按份额支付，`R = B * p`，按比例支付 [`R = B * (n/N)`，其中 `n` 是矿工的份额数量，`N` 是本轮所有份额的数量]，以及按最后 N 份额支付 [`R = B * (n/N)`，其中矿工的奖励是基于 `N` 个最后份额计算的，而不是上轮的所有份额]。所有这些方法都依赖于知道给定区块的区块奖励。为了提供一个信任最小化的解决方案，可以使用 `0x46` 来调用区块奖励以计算支付。

### 合并挖矿代币

合约可以创建代币，这些代币可以根据区块奖励的函数通过调用 `0x46` 进行可变“铸造”。

## 向后兼容性

### 当前已部署的合约

没有影响

### 当前客户端

此 EIP 将与当前无法处理 `0x46` 的已部署客户端不兼容，并将处理所有包含该操作码的交易和区块为无效。

实施应作为协调硬分叉的一部分进行。

## 实施

## 进一步阅读

[挖矿池](https://en.wikipedia.org/wiki/Mining_pool)

《黄皮书》附录 H. 虚拟机规范 H.2 节

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。