---
eip: 908
title: 奖励客户端以实现可持续网络
author: James Ray (@jamesray1), Micah Zoltu (@MicahZoltu)
discussions-to: https://ethereum-magicians.org/t/eip-908-reward-full-nodes-and-clients/241
status: 撤回
type: 标准跟踪
category: 核心
created: 2018-03-01
---

## 运行全节点的奖励已被弃用，但对客户端的奖励提案仍然存在

虽然 Casper 验证者被激励去验证交易，但目前仍然没有激励措施来转发区块和存储数据（包括状态）。本文更多的是高层次的分析和讨论，而不是试图提供一个具体的解决方案。[Pocket Network](https://www.pokt.network/) 是一个独立的区块链，旨在激励转发交易，计划与其他区块链兼容。还要注意，[Rocket Pool](https://github.com/rocket-pool/rocketpool) 正在开发中，计划成为 Casper 的一个池，这将有助于激励运行全节点。另一个替代方案是 [VIPnode](https://github.com/vipnode/vipnode.org)，它向为轻客户端提供服务的全节点收取费用。鉴于这些解决方案正在开发中，或许更合适的方式是普遍奖励客户端，激励带宽（转发和下载）、存储和 I/O（而计算已经通过矿工的 gas 得到激励，并将在分片和 Casper 下对提议者进行激励）。还要注意，在分片下，公证人将被激励下载合并数据。过时的（Casper FFG 将与以太坊 2.0 和分片一起实施：[shasper](https://notes.ethereum.org/SCIg8AH5SA-O4C1G1LYZHQ#)）：鉴于 Casper FFG 看起来很快就会实施，为了减少对协议的不必要复杂性，暂时激励验证可能被认为不值得。有关包含奖励全节点提案的提案的先前版本，请参见 [这里](https://github.com/ethereum/EIPs/commit/97e235d0ba4a88b4ce29834aa2b94107b8d91e12#diff-9a43a8739b5a9e1dec427324cb264921)。

## 简要总结
当每笔交易被验证时，给予客户端奖励以促进客户端的开发。

## 摘要
公地悲剧是一个在许多领域广为人知的现象，尤其是在可持续性方面。它涉及对共享有限资源的过度利用，这对所有参与者和利益相关者造成损害（在全球公共产品的情况下，可能包括每个人，包括未来几代人）。如果没有对公共资源的适当管理，就可能发生公地悲剧。内部化外部性（外部性可以广泛定义为未在商品、服务或资源的内在价格中考虑的影响）是激励资源适当管理的一种方式，尽管还需要其他能够真正管理资源的方法。该 EIP 提议对协议进行更改，以奖励客户端提供使以太坊正常运行的软件，奖励可以包括交易费用的一部分（减少矿工目前获得的全部比例）和一些新铸造的 ETH。因此，客户端被激励维护和改善以太坊协议和生态系统的安全性和健康性。为了总结提案中的机制，一个用户代理附加到交易上，该用户代理包含一个向量，其中包含访问列表中客户端地址的索引。客户端地址可以由客户端插入，并验证它与客户端存储中的只读常量相同。

与协议内置的奖励机制无关的奖励机制超出了该 EIP 的范围。这些额外协议奖励方法包括状态通道支付，用于提供更快的信息（如收据）的额外服务，例如轻客户端服务器；从全节点购买状态读取的状态通道支付；归档服务（仅适用于未来提议的无状态客户端版本的以太坊）；以及为客户端和运行全节点提供的代币。

## 动机
目前，运行全节点的激励措施缺乏，而加入矿池在经济上并不划算，因为现在必须购买矿机（多个 GPU），由于在以太坊过渡到混合工作量证明/权益证明与 [Casper FFG](./eip-1011.md) 以及随后完全权益证明与 [CBC Casper](https://github.com/ethereum/research/blob/master/papers/CasperTFG/CasperTFG.pdf) 之前，投资回报的可能性不大。

此外，为客户端提供奖励提供了一条独立于状态通道或其他第二层机制的收入来源，这些机制的安全性较低，尽管这种不安全性可以通过保险、担保支付和时间锁等机制来抵消。合理化投资者可能会投资于客户端，因为它是以太坊生态系统的推动者（从而开启投资机会），可能并不太可行，似乎将客户端作为其提供的服务的一部分进行货币化更为可持续。

虽然可以争辩说以太坊预挖（预 ICO 和 ICO）筹集的资金可以用于资助客户端开发，但这一论点是有争议的，因为 Parity 是风险投资资助的，其他客户端如 Prysmatic Labs [1](https://medium.com/@XYOracleNetwork?source=search_post)、[2](https://twitter.com/prylabs/status/996391036753666050)、[3](https://medium.com/prysmatic-labs/biweekly-development-update-2-d29d0c91e7d0) 和 [exthereum](https://medium.com/compound-finance/introducing-exthereum-the-newest-ethereum-client-7a5e30d4d6aa) 已从其他方获得资金，而如果以太坊预挖资金充足，他们或许就不需要这样做。[Drops of Diamond](https://github.com/Drops-of-Diamond/diamond_drops) 还未获得任何资金。

激励客户端开发将更直接地激励协议中的资源提供，防止公地悲剧的发生，在这种情况下，供应极度不足而需求过剩，导致协议无法使用。

请参见 [这里](https://eprint.iacr.org/2014/452.pdf#subsection.2.1) 以获取关于比特币、工作量证明和混合工作量证明/权益证明协议的分析。虽然以太坊有 gas 限制，但该部分指出，随着市值的增加，这还不够，而攻击网络的激励也在增加，而安全成本与交易费用的比例并没有变化，而权益证明将进一步缓解这个问题。然而，该部分指出，单靠权益证明是不够的，因为传播、验证和存储交易的成本没有得到激励。请注意，“活动证明：通过权益证明扩展比特币的工作量证明”论文中也包含了激励目标参与水平的方案。

> 短语“活动证明”中的“活动”一词强调了只有维护全在线节点的活跃利益相关者才能获得奖励，以换取他们为网络提供的重要服务。这与早期的权益证明方案形成对比，在这些方案中，离线权益可以随着时间的推移积累权重，并最终可能被用于双重支付攻击。
我们还可以激励全节点传播交易并存储交易或状态，除了验证它们之外。虽然这前两个激励措施超出了本 EIP 的范围，但有提案 [在这里](https://ethresear.ch/t/incentivizing-a-robust-p2p-network-relay-layer/1438) 和 [在这里](https://ethresear.ch/t/incentivizing-full-state-nodes/1640)。

将其作为第二层解决方案实施可能无法确保协议的可持续性，因为并不是每个人都会使用它；如果协议对全节点验证交易没有任何成本，那么人们将利用这一点而不使用第二层解决方案。似乎至少应该在协议中包含奖励的部分，但这和用户代理签名并没有真正为协议增加其他内容，因此可以在协议中做一些部分，而在协议外做一些部分，例如验证或验证游戏，但这已经在协议中完成。还要注意，一些计算密集型任务在协议中可行性太低，例如由于不符合 gas 限制，可以通过 Truebit 完成，其中验证者有激励。

现在不为客户端提供激励是一个问题，因为构建与用户需求对齐的客户端的激励较少，资金需要在协议外筹集以资助客户端开发，这并不那么去中心化。如果只有较小的子集能够资助客户端开发，例如风险投资公司、天使投资者和机构投资者，这可能与以太坊所有当前和潜在利益相关者（包括未来利益相关者）的利益不太一致。显然，以太坊的目标之一是去中心化一切，包括财富，换句话说，改善财富平等。不为验证交易的全节点提供激励现在可能看起来不是一个大问题，但不这样做可能会阻碍协议的增长。当然，激励并不够，它还需要在技术上去中心化，以便理想情况下低端主流计算机，甚至移动或嵌入式物联网设备能够成为验证全节点，或者至少能够帮助保护网络，如果被认为不切实际成为全节点。

请注意，通过供应上限（如 [EIP-960](https://github.com/ethereum/EIPs/issues/960)），可以防止发行量无限增加。或者，它至少可以减少（仍然可能但不一定为零，或与以太燃烧的速率相同，例如在 Casper PoS 方案下的验证者或分片方案下的公证人），例如通过硬分叉，或根据 [EIP-1015](./eip-1015.md)，由决策大会管理的链上合约，该合约从代表某些利益相关者集合的其他合约获取信号。

## 规范
在每个区块中添加一个新字段 `PrevBlockVerifications`，这是一个任意、无限大小的字节数组。当客户端验证先前区块是 [有效](https://ethereum.github.io/yellowpaper/paper.pdf#subsubsection.4.3.2) 时，客户端通过交易中的操作码 PREV_BLOCK_VERIF 将用户代理附加到 PrevBlockVerifications。用户代理是一个向量，具有不可变字段：被验证区块的区块哈希和访问列表中客户端地址的索引（详细信息如下）。矿工在将交易包含在区块中之前验证交易，但他们无法更改向量的这些字段，因为它们是不可变的。

在区块处理时向客户端发送 0.15 ETH（见下面的理由）。这些金额可以包括交易费用的一部分（虽然矿工将获得更少），这将减少新发行的 ETH。这些金额在区块中的新 `ClientReward` 字段中指定。

为了仅激励验证最近的区块，断言与区块哈希对应的区块号小于 400 个区块之前。

### 攻击及其防范的附加规范

矿工可以创建一个客户端，并用仅包含 PREV_BLOCK_VERIF 操作码的交易填充他们的区块（或者，替代地，包含仍然带有操作码的任意复杂交易），其中包含他们已验证的先前区块哈希和他们客户端的地址。为了防止这种情况，状态必须存储一个包含列表的列表，每个子列表列出与矿工对应的最多 400 个区块之前的区块哈希，然后矿工（或在 Casper CBC 下的提议者）必须存入押金，如果提议者插入这样的交易（包含他们已经提议过的区块哈希，不仅仅是在区块中，而是在任何时间之前）则会被削减。更新状态以删除超过 400 个区块之前的区块哈希将增加额外的开销，尽管可以为较旧的区块添加额外的窗口，例如 120,000 个区块（大约每 3 周），仍然忽略超过 400 个区块之前的区块，并每 120,000 个区块删除这些较旧的 120,000 个区块。攻击者可以贿赂矿工/提议者包含上述交易，这些交易包含他们拥有的访问列表中的客户端地址。然而，上述削减条件应该会抑制这种行为。

### 访问列表的更多细节

访问列表防止任何人将任何地址插入向量的第一个元素，可能有办法防止审查和集中化谁决定在列表中注册新地址，例如通过链上治理与信号（可能类似于 [EIP-1015](./eip-1015.md)，它还指定了一种替代的资金发送方式）或通过智能合约添加新地址的第二层权威证明网络。请注意，实施这些列出的示例可能会有严重缺陷。对 [链上治理](https://medium.com/@Vlad_Zamfir/against-on-chain-governance-a4ceacd040ca) 和 [富人统治](https://vitalik.ca/general/2018/03/28/plutocracy.html) 的反驳。 [权威证明](https://en.wikipedia.org/wiki/Proof-of-authority) 不适合公共网络，因为它没有很好地分配信任。然而，在第二层合约中使用信号更可接受，但 Vlad Zamfir 认为，使用它来影响协议中的结果可能会使矿工失去作为治理过程必要参与者的资格。因此，考虑到这些反对意见，直到实施并理想上被以太坊用户群体的随机样本大多数接受的去中心化、无信任的维护方式，拥有访问列表可能不合适。

然而，管理访问列表的另一种替代方案是去中心化验证，从查询访问列表中的索引生成的地址确实对应于“合法”客户端。此验证的一部分将涉及检查是否有客户端声称该地址由他们拥有，他们愿意以这种方式接收资金并同意或安排将该地址放入访问列表，并且该客户端通过 [以太坊测试套件](https://github.com/ethereum/tests) 的所有测试。然而，这最后的附加条件将排除新客户端在开发开始时获得资金，尽管这些潜在的客户端在实现客户端之前无法在协议中接收资金（顺便说一下，他们可以通过各种方式筹集资金——推荐使用 DAII，发音为 die-yee，而一个 DAII 平台正在由 [Dogezer](https://dogezer.com/) 开发）。所有这些可以在链下完成，如果有人发现访问列表中的某个地址不合法，他们可以用不合法的证明挑战该地址，而提交该地址到访问列表的参与者可以被削减（同时他们必须持有押金以注册和保留访问列表中的地址）。
此外，它应该有助于仅能从客户端读取客户端的地址，如果地址不在访问列表中，整个交易可能会回滚。您可以提供访问列表中地址的索引，然后您可以`assert`该索引处找到的地址与客户端可以读取的地址匹配（后者将是只读地址）。

## 理由

### 费用的粗略定性分析

截至 2018 年 5 月 4 日，存在 [16428 个节点](https://web.archive.org/web/20180504051128/https://ethernodes.org/network/1) 。假设一个平均客户端开发组织的年成本为 100 万美元。向前推算（并注意，如果实施此 EIP，节点数量应该会大幅增加，从而有助于以太坊去中心化的目标），假设有 10 个客户端。因此，假设在 5 年内节点数量翻倍至 30000 个节点（这个假设可能是保守的，即使是前瞻性的）。为了简单起见，假设客户端的成本完全由这个区块奖励覆盖。

每个客户端的平均成本 = 节点数量 * 每个客户端的区块奖励 / 客户端数量

每个客户端的区块奖励（ETH 价格的最坏情况） = 每个客户端的平均收入 * 客户端数量 / (ETH 汇率 * 节点数量)

= $2,000,000 * 10 / (500 * 30,000)

= 1.333333333 ETH

每个客户端的区块奖励（较好情况） = $1,000,000 * 10 / (2000 * 30,000) = 0.166666667 ETH

假设我们为客户端使用 0.15 ETH 的区块奖励。

<!--目前已有超过 5552465 个区块，并在不断增加。每个区块的奖励为 0.001 ETH，一个验证每个区块的完整状态节点将获得 5552.465 ETH。然而，验证区块的难度随着时间的推移而增加，因此-->

### 更多理由（被上述内容淘汰）

验证交易所需的计算量将与矿工相同，因为需要执行交易。因此，如果验证完整节点和客户端的交易需要交易费用，并且交易需要由验证者执行，就像矿工一样，那么以与矿工的 gas 费用相同的方式计算它们是有意义的。这将有争议地大幅增加交易费用，因为一个交易可能有许多验证者。换句话说，是否为完整节点验证者提供与矿工相同的交易费用是有争议的（在某种程度上这是公平的，因为验证者必须进行相同数量的计算），或者防止交易费用大幅上升，并将完整节点的交易费用设定为矿工的交易费用除以验证交易的完整节点的平均数量。后者的选项似乎更具争议（但仍然比现状更好），因为虽然运行完整节点的激励会比现在没有激励时更大，但验证者在执行相同数量的计算时获得的报酬会更少。

至于绝对金额，这将需要数据分析，但显然，完整节点在处理区块中的交易时应该获得的报酬远低于矿工，因为一个区块中有许多交易，并且一个区块有许多确认。数据分析可能涉及计算验证区块中交易的完整节点的平均数量。宏观经济分析可能涉及完整节点为网络提供的经济安全利益。

现在，关于客户端与完整节点的奖励比例，作为初步猜测，我建议类似 99:1 的比例。为什么差异如此之大？因为我猜测客户端在开发和维护客户端上花费的时间大约是完整节点用户运行和维护完整节点的 99 倍。在一周内，可能有几个人全职工作在客户端上，但完整节点可能只需花费半小时（或更少）来初始设置，加上运行它的时间，以及电费和互联网费用。完整节点操作员可能不需要升级他们的计算机（而且考虑到即将实施的 Casper PoS，购买矿机是没有价值的）。

然而，经过进一步分析，客户端还将从每个运行客户端的完整节点获得大量奖励，因此为了进一步激励完整节点的运行，比例可以改为 4:1，甚至 1:1，当然可以通过进一步的实际数据分析进行调整，而不是猜测。

向完整节点验证者和客户端提供奖励将增加发行量。为了保持当前水平的发行量，此 EIP 还可以减少挖矿奖励（尽管在 2017 年 10 月的拜占庭发布中已从 5 ETH 减少到 3 ETH），但这将引发更多争议和讨论。

奖励客户端和完整节点的另一个潜在争议点是，他们之前所做的工作直到现在都没有得到报酬（当然，除了以太坊基金会或 Parity 风险投资资助的工作），因此现有客户端可能会说此 EIP 给新进入者带来了优势。然而，这并不成立，因为现有客户端具有先发优势，已经进行了大量开发以创建有用且被广泛使用的产品。

这是一个权衡。更高的费用意味着您可能会排除贫困人群和那些不想支付费用的人。但如果一台笔记本电脑可以运行完整节点并获得报酬，那么这将通过使用来抵消费用。完整节点确实提供了安全利益，因此给予的总费用至少可以是这一利益的一部分。用于客户端开发的费用激励更高质量的客户端。在我看来，尽可能内部化成本是更有意义的：对于计算、存储、带宽、I/O、客户端开发、运行完整节点、挖矿/验证等。通过外部化成本来避免公地悲剧。您内部化成本越多，越可持续，越不依赖于富人慷慨等。（尽管，从哲学上讲，最终您无法强迫富人慷慨，他们必须出于善良的心而这样做。）

关于完整节点的奖励，在[草案阶段 1 分片规范](https://ethresear.ch/t/sharding-phase-1-spec/1407)中，作为完整节点的提议者在提议包含在合并/区块中的 blob（不执行）或稍后在阶段 3 的交易（执行）时获得奖励。因此，这将有所帮助。然而，不作为提议者并仅验证交易的完整节点，或[完整状态节点](https://ethresear.ch/t/incentivizing-full-state-nodes/1640) ，仍然没有激励。

请注意，虽然需要进一步的定量分析来具体说明费用，但在链上实施此方法后，可能需要某种程度的实验。

### 安全性
所有以下划线的信息应通过使用访问列表并验证客户端提供的只读地址与访问列表中的地址匹配来防止，以及使用诸如 PoA 网络之类的第二层解决方案以抵御审查和最小化访问列表中的集中化。

进一步讨论请见 https://ethresear.ch/t/incentives-for-running-full-ethereum-nodes/1239。
## 向后兼容性

引入协议内费用是一个向后不兼容的变化，因此将通过硬分叉引入。

## 测试用例
待办事项

## 实现
待办事项

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。