---
eip: 7782
title: 降低峰值带宽的插槽时间
description: 将以太坊的插槽时间从 12 秒减少到 8 秒，以提高约 33%的吞吐量，分配带宽使用，并改善汇总延迟。
author: Ben Adams (@benaadams)
discussions-to: https://ethereum-magicians.org/t/eip-7782-reduce-slot-time-for-lower-peak-bandwidth/21271
status: Draft
type: Standards Track
category: Core
created: 2024-10-05
requires: 7623, 7778
---

提议将以太坊的插槽时间从 12 秒减少到 8 秒，以提高三分之一的交易吞吐量。这种方法在时间上分配带宽使用，降低峰值带宽需求，而不增加单个区块或数据块的数量。它需要 [EIP-7623](./eip-7623) 和 [EIP-7778](./eip-7778) 以确保网络在更高区块率下的稳定性和效率。

## 摘要

本 EIP 建议将以太坊的权益证明（PoS）共识机制中的插槽时间从 12 秒减少到 8 秒。减少插槽时间增加了每单位时间的插槽数量，从而将网络的交易处理能力提高约 33%。

与直接增加 gas 限制或数据块限制不同；这将提高峰值带宽需求，该提案在时间上均匀分配增加的带宽，防止网络负载的突然峰值，并保持不同带宽能力参与者的节点可访问性。

此更改需要实施 [EIP-7623](./eip-7623) 以相应调整 calldata 成本，并且需要 [EIP-7778](./eip-7778) 以通过退款消除 gas 走私，以维持网络性能。

## 动机

### 分配带宽和减少峰值使用

- **避免峰值带宽增加**：将 gas 限制从 3000 万增加到 4000 万，或将数据块限制从 6 增加到 8，直接提高了单个区块或数据块的大小，导致更高的峰值带宽需求，这可能会给网络资源带来压力，并使带宽有限的节点处于不利地位。

- **在时间上分配带宽**：减少插槽时间增加了区块的频率，更均匀地分配带宽使用，避免网络负载的突然峰值。

- **吞吐量增强**：将插槽时间从 12 秒减少到 8 秒，相当于时间减少三分之一，导致每单位时间的插槽增加三分之一。这与将 gas 限制或数据块限制增加三分之一所带来的吞吐量增益相似。

### 补充 EIP-7623

- **EIP-7623 对齐**：EIP-7623 增加了 calldata 成本，以减少最大区块大小和方差。与插槽时间减少一起实施，确保区块保持可管理的大小，并且网络能够在不妥协安全性或效率的情况下处理增加的区块频率。

## 规范

### 插槽时间减少

- **更改插槽时间参数**：将以太坊共识规范中的插槽时间（`SECONDS_PER_SLOT`）从**12 秒**修改为**8 秒**。

### 时间参数调整

- **纪元长度**：

  - **每个纪元的插槽**：保持当前每个纪元的插槽数量（32 个插槽）。
  - **纪元持续时间**：在 8 秒的插槽时间下，如果每个纪元的插槽数量保持不变，则每个纪元将持续 256 秒（4.267 分钟）。

- **超时和截止日期**：

  - **证明截止日期**：调整证明聚合和广播截止日期，以与新的插槽持续时间对齐。
  - **提议者截止日期**：更新区块提议时间，以确保提议者有足够的时间准备和广播区块。

- **同步协议**：

  - **网络参数**：更新网络协议，以考虑到消息频率的增加，并确保区块和证明的及时传播。

### 验证者操作

- **频率增加**：

  - **区块提议**：由于插槽时间缩短，验证者将更频繁地提议区块。
  - **证明**：验证者需要在更短的间隔内执行证明职责。

- **资源管理**：

  - **客户端性能**：优化验证者客户端，以在不消耗过多资源的情况下处理增加的操作需求。
  - **带宽使用**：确保带宽较低的验证者能够处理消息频率的增加。

## 理由

### 基于汇总的延迟

- 将插槽时间从 12 秒减少到 8 秒显著改善了基于汇总的第二层解决方案的延迟，因为它们直接受到 L1 延迟的影响。

### 在不提高峰值带宽的情况下增加吞吐量

- **保持单个区块大小**：通过保持区块和数据块大小不变，我们避免了增加峰值带宽需求。

- **分配工作负载**：更频繁的区块在时间上分配了网络的工作负载，从而导致更平稳的操作并减少拥堵风险。

### 补充 EIP-7623

- **管理区块大小**：EIP-7623 增加了 DA 密集型交易的 calldata 成本，减少了最大可能的区块大小。这在减少插槽时间时至关重要，以防止超大区块导致传播延迟。

- **网络效率**：这两个提案确保网络能够在不妥协安全性或去中心化的情况下处理增加的吞吐量。

### 验证者能力

- **操作可行性**：预计验证者能够处理增加的频率，因为每个区块的计算工作负载保持一致。网络中有足够的性能使 EL 能够以更高的速率处理（因为 L2 以更高的速率运行相同的 EL 客户端）。由于网络有足够的松弛时间来进行时间游戏，因此也有足够的时间达成共识。

- **资源优化**：客户端软件可以在新条件下有效管理资源。

### 增加区块大小或数据块数量的替代方案

- **避免缺点**：更大的区块或更多的数据块可能导致更长的验证时间和传播延迟，可能会导致网络集中化。减少插槽时间可以避免这些问题。

### 向后兼容性

- **需要网络升级**：此更改与向后不兼容，需要进行硬分叉。

- **客户端更新**：所有以太坊客户端必须更新以适应新的插槽时间和相关协议调整。

- **智能合约和 DApp**：

  - **区块时间**：依赖于区块时间戳或假设 12 秒插槽时间的应用程序可能需要调整。
  - **事件时间**：事件驱动的应用程序应进行测试，以确保在增加区块频率的情况下正常功能。

### 测试用例

- **网络条件模拟**：

  - **延迟场景**：在各种延迟条件下测试网络，以评估区块传播成功率。
  - **带宽限制**：评估不同带宽能力节点的性能。

- **验证者性能指标**：

  - **资源利用率**：监控验证者的 CPU、内存和网络使用情况。
  - **职责合规性**：确保验证者能够满足证明和区块提议的截止日期。

- **共识稳定性测试**：

  - **分叉场景**：模拟潜在的分叉条件，以检测任何共识漏洞。
  - **最终性保证**：验证网络是否一致地达到最终性。

### 网络传播考虑

- **延迟和带宽**：

  - **传播速度**：评估和优化网络在减少的插槽时间内传播区块和证明的能力。
  - **Gossip 协议增强**：实施改进以加快共识消息的传播。
- **优化**：

  - **区块和证明压缩**：使用高效的序列化和压缩技术来减少消息大小。
  - **节点选择策略**：优化节点选择，以优先连接能够提高传播速度的节点。

### 共识调整

- **分叉选择规则**：

  - **LMD GHOST 调整**：验证最新消息驱动的贪婪最重观察子树（LMD GHOST）分叉选择算法在增加区块频率的情况下是否正常运行。

- **最终性机制**：

  - **Casper FFG 稳定性**：确保 Casper 友好的最终性小工具（FFG）最终性机制在新的时间条件下保持稳定和可靠。

### 实施

- **客户端修改**：

  - **更新时隙时间**：将 `SECONDS_PER_SLOT` 常量更改为 8 秒。
  - **调整时间参数**：修改所有时间依赖逻辑，包括纪元、超时和调度。

- **协议规范更新**：

  - **共识规范**：更新以太坊共识规范，以反映新的时隙持续时间和任何相关参数的变化。
  - **网络协议**：调整网络规范以处理增加的消息频率。

- **部署计划**：

  - **测试网**：在测试网络（例如 Sepolia 等）上实施更改以进行广泛测试。
  - **监控**：使用监控工具观察网络性能并识别问题。

- **社区协调**：

  - **沟通**：通知所有利益相关者，包括节点运营商、验证者、交易所和 DApp 开发者。
  - **支持和资源**：提供文档和支持以更新客户端软件和应用程序。

## 安全考虑

- **网络拥堵**：

  - **增加的消息频率**：网络必须处理更频繁的消息而不发生拥堵。
  - **缓解措施**：实施网络优化并鼓励使用高效的客户端软件。

- **共识完整性**：

  - **分叉选择稳定性**：确保分叉选择规则在潜在的重组攻击下保持稳健。
  - **最终性小工具**：确认最终性机制在新的时间条件下正常运行。

## 版权

版权及相关权利通过 CC0 1.0 Universal 放弃。