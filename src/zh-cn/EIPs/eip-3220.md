---
eip: 3220
title: 跨链标识符规范
author: Weijia Zhang (@weijia31415), Peter Robinson (@drinkcoffee)
discussions-to: https://ethereum-magicians.org/t/eip-3220-crosschain-id-specification/5446
status: Stagnant
type: Standards Track
category: Core
created: 2020-10-21
---

## 简单总结

一个自我验证的唯一区块链标识符，处理分叉问题。

## 摘要

跨链标识符是一个 32 字节的十六进制字符串，部分字节提取自区块链哈希，部分手动定义以表征区块链。
我们还提议一个注册和查找服务，以从跨链标识符中检索区块链元数据。

## 动机

随着比特币和以太坊的成功，各种区块链如 EOS、Ripple、Litecoin、Besu、Wanchain 等相继开发，并快速增长。 还有其他私有和联盟区块链，如 Hyperledger Fabric、Hyperledger Besu、Stellar、Corda、Quorum，仅允许具有许可身份的节点加入区块链网络。 公共和私有区块链的增长对链间互操作性提出了挑战，特别是当这些链是异构和不兼容时。 企业以太坊联盟成立了跨链互操作性工作组（CITF），以研究共同的跨链问题和解决方案。 CITF 团队注意到缺乏唯一标识符来表征和描述区块链。在 EEA 跨链互操作性工作组会议和讨论中讨论了几项提案。

[EIP-155](./eip-155.md)为区块链提供了唯一标识符，以提供简单的中继攻击保护。 本规范定义了一个区块链的链标识符（Chainid），并将链标识符签入交易数据，从而防止攻击者将相同的交易发送到不同的区块链。 本规范将要求区块链定义链标识符并在公共存储库中注册链标识符。

使用整数作为链标识符的挑战在于，它不足以覆盖所有区块链，并且无法防止不同区块链使用相同的链标识符。 此外，它未解决两个分叉区块链具有相同链标识符的问题。

因此，需要一个更强大的区块链标识符，以克服这些缺点，特别是在涉及多个链的跨链操作中。 一个区块链标识符（跨链标识符）应该是唯一的，并满足以下要求：

* 应提供区块链的识别、描述和发现。
* 应提供跨链服务生态系统中每个区块链的唯一识别。
* 应提供区块链身份的描述，如链标识符、名称、类型、共识机制等。
* 应提供支持的区块链以及生态系统中新区块链的发现机制。
* 应提供一个机制，使加入的区块链能够注册到生态系统中。
* 应提供一个机制，使区块链能够编辑属性或从跨链生态系统中注销。
* 应提供一个机制，以获取区块链的一些关键信息。
* 应提供一个机制，以区分原始区块链和分叉区块链。
* 应提供一个机制，以在没有外部注册服务的情况下验证链标识符。

## 规范

### 32 字节跨链标识符的定义

| 名称          | 大小（字节） | 描述 |
|---------------|-------------|-------------|
| 截断区块哈希 | 16 | 这是创世区块的区块哈希或分叉前一个区块的区块哈希。16 字节是 16 个最低有效字节，假设网络字节顺序。|
| 本链标识符 | 8 | 这是在签署交易时应与区块链一起使用的**链标识符**值。对于没有**链标识符**概念的区块链，此值为零。|
| 链类型 | 2 | 保留 0x00 作为未定义链类型。0x01 作为主网类型。0x1[0-A]: 测试网，0x2[0-A]: 私有开发网络|
| 治理标识符 | 2 | 对于新区块链，可以指定治理标识符以识别区块链的原始**所有者**，以帮助解决分叉/主链争议。对于所有现有区块链和没有**所有者**概念的区块链，此字段为零。 |
| 保留 | 3 | 保留以备将来使用。现在使用 000000。 |
| 校验和 | 1 | 用于验证标识符的完整性。此完整性检查旨在检测人为用户输入错误的跨链标识符。该值计算为其余标识符的截断 SHA256 消息摘要，使用最低有效字节，假设网络字节顺序。请注意，此校验和字节仅以 256 分之一的概率检测完整性。此概率对于检测人为输入跨链标识符的排版错误的预期使用是足够的。|

## 理由

我们考虑了各种替代规范，例如使用随机唯一的十六进制字符串来表示区块链。 这种方法的缺点在于，随机标识符无法验证区块链的内在身份，例如创世区块的区块哈希。 第二种替代方案是简单地使用创世区块哈希来表示跨链操作的区块链标识符。 这种方法的缺点在于，该标识符没有关于区块链属性的信息，并且在区块链分叉为两个区块链时存在问题。

## 向后兼容性

跨链标识符可以与 EIP-155 向后兼容。 跨链标识符包含一个 8 字节的段来记录`本链标识符`。
对于以太坊链，可以用于与 EIP-155 一起使用的值。

## 安全考虑

跨链标识符的冲突：两个区块链可以包含相同的跨链标识符，从而导致错误地将资产转移到错误的区块链。
此安全问题通过将跨链标识符的哈希与创世区块的哈希进行比较来解决。 如果匹配，则验证跨链标识符。 如果不匹配，则可以将跨链标识符与分叉区块哈希进行比较。 如果没有任何区块哈希与跨链标识符哈希匹配，则无法验证跨链标识符。

防止中继攻击：尽管跨链标识符本身与链标识符不同，并且未签入区块链交易，但跨链标识符仍可用于呈现中继攻击。 处理跨链交易的应用程序可以使用其区块哈希验证跨链标识符，并决定交易是否有效。 任何具有不可验证跨链标识符的交易应被拒绝。

跨链标识符不需要签入区块链交易。
对于未将跨链标识符以加密方式签入区块的区块链，跨链标识符无法与区块本身进行验证，必须通过基于跨链标识符规范实现的外部智能合约地址和链下工具进行验证。

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。