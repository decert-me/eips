---
eip: 7514
title: 添加最大纪元更替限制
description: 修改更替限制函数，将其上限设为最大值
author: dapplion (@dapplion), Tim Beiko (@timbeiko)
discussions-to: https://ethereum-magicians.org/t/eip-7514-add-max-epoch-churn-limit/15709
status: Final
type: Standards Track
category: Core
created: 2023-09-07
---

## 摘要

通过限制纪元更替限制，将最大验证者增长率从指数增长更新为线性增长。

## 动机

该提案旨在减轻在实施适当解决方案之前，过高的总 ETH 供应质押所带来的负外部性。换句话说，该提案接受了改变奖励曲线的复杂性，仅旨在减缓增长。

如果存款队列保持 100% 满，质押的 ETH 供应份额将在 2024 年 5 月达到 50%，2024 年 9 月达到 75%，2024 年 12 月达到 100%。虽然随着验证者集大小的增加，奖励会减少，但在 100% ETH 供应质押的情况下，验证者的年度共识奖励（不包括 MEV/交易费用）仍然约占其质押的 ~1.6%。这一小收益并不一定会阻止额外资本的质押，因为 MEV 的收益往往更高且不可预测。因此，验证者集大小的均衡点可能接近其最大可能值。流动质押代币（LSTs）也对此有所贡献，因为质押者可以像使用未质押的 ETH 一样使用它们。

随着质押的 ETH 增加，对共识层的压力也随之增加。更多的验证者会导致 gossip 消息的增加，以及 Beacon 状态大小的增长。此外，随着质押量的增加，额外经济权重带来的边际安全收益也不明确。

Beacon 链的验证者奖励函数是在 2020 年其启动之前选择的。PoS 研究和奖励曲线设计是在一个没有 MEV 的世界中进行的。自那时以来，情况发生了很大变化，包括 Beacon 链取得了前所未有的成功，超出了原本预期的质押率目标。鉴于此，值得讨论是否应调整 Beacon 链验证者的奖励，以更好地匹配今天的现实，可能会在某个点上抑制质押。

该 EIP 并不试图做到这一点，而是为社区提供更多时间进行这些讨论。通过现在限制纪元更替限制，达到总 ETH 供应质押的关键里程碑的时间将显著延迟。这为更全面解决方案的研究提供了更多时间，并为社区共识的形成提供了机会。

## 规范

### 常量

| 名称 | 值 |
| ---- | ----- |
| `MAX_PER_EPOCH_ACTIVATION_CHURN_LIMIT` | 8 |

### 执行层

这不需要对执行层进行更改。

### 共识层

- 添加 `get_validator_activation_churn_limit`，上限为 `MAX_PER_EPOCH_ACTIVATION_CHURN_LIMIT`
- 修改 `process_registry_updates` 以使用有界的激活更替限制

提议更改的完整规范可以在 [`/specs/deneb/beacon-chain.md`](https://github.com/ethereum/consensus-specs/blob/69d34dc4ee3d026ca437d1b6875b218e8aaf3a5c/specs/deneb/beacon-chain.md) 中找到。

## 理由

### `MAX_PER_EPOCH_CHURN_LIMIT` 值

根据具体常量选择，更替可以在激活分叉纪元时 _减少_。Beacon 链规范可以处理这一点而不会出现问题。在 2023 年第四季度（预计 Dencun 激活）期间，更替值将范围在 14-16 之间。下表比较了假设存款队列持续满额的预期验证者集。

#### `MAX_PER_EPOCH_CHURN_LIMIT` 激活日期：2023 年 12 月 01 日

|   最大更替限制 | 50% ETH 质押   | 75% ETH 质押   | 100% ETH 质押   |
|------------------:|:-----------------|:-----------------|:------------------|
|               inf | 2024 年 5 月 28 日 | 2024 年 9 月 25 日 | 2024 年 12 月 18 日 |
|                16 | 2024 年 7 月 23 日 | 2025 年 4 月 10 日 | 2025 年 12 月 26 日 |
|                12 | 2024 年 10 月 9 日 | 2025 年 9 月 21 日 | 2026 年 9 月 4 日 |
|                 8 | 2025 年 3 月 15 日 | 2026 年 8 月 18 日 | 2028 年 1 月 21 日 |
|                 6 | 2025 年 8 月 19 日 | 2027 年 7 月 14 日 | 2029 年 6 月 8 日 |
|                 4 | 2026 年 6 月 29 日 | 2029 年 5 月 5 日 | 2032 年 3 月 12 日 |

#### `MAX_PER_EPOCH_CHURN_LIMIT` 激活日期：2024 年 4 月 01 日

|   最大更替限制 | 50% ETH 质押   | 75% ETH 质押   | 100% ETH 质押   |
|------------------:|:-----------------|:-----------------|:------------------|
|               inf | 2024 年 5 月 28 日 | 2024 年 9 月 25 日 | 2024 年 12 月 18 日 |
|                16 | 2024 年 7 月 1 日  | 2025 年 3 月 18 日 | 2025 年 12 月 4 日 |
|                12 | 2024 年 8 月 1 日  | 2025 年 7 月 14 日 | 2026 年 6 月 26 日 |
|                 8 | 2024 年 10 月 1 日 | 2026 年 3 月 5 日  | 2027 年 8 月 8 日 |
|                 6 | 2024 年 12 月 1 日 | 2026 年 10 月 26 日 | 2028 年 9 月 20 日 |
|                 4 | 2025 年 4 月 2 日  | 2028 年 2 月 7 日  | 2030 年 12 月 15 日 |

假设下一个分叉最早发生在 2024 年第三季度初，值为 8 可以显著减少预期规模，而不会在预计的 Dencun 分叉日期造成大幅下降。值为 8 可以防止在延迟的 Dencun 分叉情况下，至少一年内达到 50% ETH 质押的水平。

## 向后兼容性

该 EIP 引入了对共识层区块验证规则集的向后不兼容更改，必须伴随硬分叉。

## 测试用例 

该 EIP 的测试用例可以在 `consensus-specs` 仓库的 [`deneb`](https://github.com/ethereum/consensus-specs/tree/2297c09b7e457a13f7b2261a28cb45777be82f83/tests/core/pyspec/eth2spec/test/deneb) 测试套件中找到。

## 安全考虑

该 EIP 打破了验证者进入和退出队列之间的对称性，前者受 `MAX_PER_EPOCH_ACTIVATION_CHURN_LIMIT` 的限制，而后者则不受限制。

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。