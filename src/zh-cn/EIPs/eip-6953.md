---
eip: 6953
title: 网络升级激活触发机制
description: 网络升级激活机制的详尽列表
author: Tim Beiko (@timbeiko)
discussions-to: https://ethereum-magicians.org/t/eip-6666-network-upgrade-activation-triggers/14047
status: Final
type: Informational
created: 2023-04-28
requires: 2982, 3675, 6122
---

## 摘要

本 EIP 概述了以太坊在不同时间段内使用的各种网络升级激活触发机制，从工作量证明时代到合并后的第一次网络升级，上海/卡佩拉，涵盖执行层和共识层。

## 动机

本 EIP 旨在为用户和开发者提供一个关于以太坊历史上各种升级激活模式的单一真实来源。它并不旨在成为一个全面的、持续的升级及其激活机制的记录。读者应假设未来的升级使用 [合并后升级](#post-merge-upgrades) 部分中描述的机制，除非本 EIP 被其他 EIP 取代。

## 规范

### 工作量证明网络升级

在工作量证明时代，以太坊的网络升级是基于特定区块号触发的。以下升级遵循此模式：

| 升级名称           | 激活区块号         |
|--------------------|-------------------|
| Frontier           | `1`               |
| Frontier Thawing   | `200000`          |
| Homestead          | `1150000`         |
| DAO Fork           | `1920000`         |
| Tangerine Whistle  | `2463000`         |
| Spurious Dragon    | `2675000`         |
| Byzantium          | `4370000`         |
| Constantinople     | `7280000`         |
| Petersburg         | `7280000`         |
| Istanbul           | `9069000`         |
| Muir Glacier       | `9200000`         |
| Berlin             | `12244000`        |
| London             | `12965000`        |
| Arrow Glacier      | `13773000`        |
| Gray Glacier       | `15050000`        | 

### 信标链启动

信标链的启动遵循 [EIP-2982](./eip-2982.md) 中详细列出的条件。一旦满足以下所有条件，启动将被激活：

1. 信标链存款合约从 `16384` 个验证者那里接收至少 `524288` ETH。
2. `MIN_GENESIS_TIME` 时间戳 `1606824000`（2020 年 12 月 1 日）已被超过。
3. 自最小验证者数量超过后，已过去 `604800` 秒的 `GENESIS_DELAY`。

### 信标链升级

信标链升级在特定的纪元激活。以下升级遵循此模式：

| 升级名称 | 激活纪元 |
|----------|----------|
| Altair   | `74240`  |
| Bellatrix| `144896` |

### 合并：巴黎升级

巴黎升级，即“合并”的执行层部分，是由工作量证明的总难度值 `58750000000000000000000` 触发的，如 [EIP-3675](./eip-3675.md) 中所述。请注意，信标链上 Bellatrix 升级的激活是巴黎升级在工作量证明链上成功激活的前提。

### 合并后升级

在合并后，网络升级在共识层（CL）的一个纪元触发，理想情况下映射到历史根累加器边界（即，7192 纪元的倍数）。该纪元对应的时间戳，而不是区块号，随后在执行层（EL）中用作激活触发器。以下升级遵循此模式：

| 升级名称       | 激活纪元 | 激活时间戳       |
|----------------|----------|------------------|
| Capella (CL)   | `194048` |                  |
| Shanghai (EL)  |          | `1681338455`     |

请注意，纪元 `194048` 发生在时间戳 `1681338455`。换句话说，升级在执行层和共识层同时激活，尽管它们各自使用不同的常量来触发。

此外，执行层上时间戳的使用导致节点的 `FORK_HASH` 和 `FORK_NEXT` 值的计算方式发生变化。这些在 [EIP-6122](./eip-6122.md) 中进行了描述。

## 理由

### 区块和纪元

区块和纪元作为升级的自然触发点，因为它们代表了以太坊上状态转换发生的级别。

### 终端总难度

关于终端总难度机制的理由可以在 [EIP-3675](./eip-3675.md) 中找到。

### 时间戳

由于信标链上可能会错过的时隙，执行层不能仅依赖区块号来与共识层同步触发升级。

时间戳保证映射到特定的纪元，并且在其 Unix 表示中，时间戳总是大于之前使用的区块号。这为合并后在执行层上触发升级提供了一种可靠的方法，同时确保基于时间戳的合并后升级永远不会使用被认为低于最后一个区块触发的升级的值。

## 安全考虑

无。

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。