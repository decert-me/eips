---
eip: 1948
title: éåŒè´¨åŒ–æ•°æ®ä»£å¸
author: Johann Barbie (@johannbarbie), Ben Bollen <ben@ost.com>, pinkiebell (@pinkiebell)
discussions-to: https://ethereum-magicians.org/t/erc-non-fungible-data-token/3139
status: åœæ»
type: æ ‡å‡†è·Ÿè¸ª
category: ERC
created: 2019-04-18
requires: 721
---

## ç®€å•æ€»ç»“

ä¸€äº› NFT çš„ä½¿ç”¨æ¡ˆä¾‹éœ€è¦ä¸éåŒè´¨åŒ–ä»£å¸å…³è”çš„åŠ¨æ€æ•°æ®ï¼Œè¿™äº›æ•°æ®å¯ä»¥åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿå˜åŒ–ã€‚åŠ¨æ€æ•°æ®çš„ç¤ºä¾‹ï¼š
- å¯ä»¥æ”¹å˜é¢œè‰²çš„åŠ å¯†çŒ«
- ç¼–ç æƒåˆ©æŒæœ‰è€…çš„çŸ¥è¯†äº§æƒä»£å¸
- å­˜å‚¨æ•°æ®ä»¥ä¾¿åœ¨é“¾é—´ä¼ è¾“çš„ä»£å¸

ç°æœ‰çš„å…ƒæ•°æ®æ ‡å‡†ä¸è¶³ï¼Œå› ä¸ºæ•°æ®åªèƒ½åœ¨é“¸é€ æ—¶è®¾ç½®ï¼Œä¹‹åæ— æ³•ä¿®æ”¹ã€‚

## æ‘˜è¦

éåŒè´¨åŒ–ä»£å¸ (NFT) æ‰©å±•äº†å­˜å‚¨åŠ¨æ€æ•°æ®çš„èƒ½åŠ›ã€‚æ·»åŠ äº†ä¸€ä¸ª 32 å­—èŠ‚çš„æ•°æ®å­—æ®µï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªè¯»å–å‡½æ•°ä»¥è®¿é—®å®ƒã€‚å†™å…¥å‡½æ•°å…è®¸æ›´æ–°æ•°æ®ï¼Œå¦‚æœè°ƒç”¨è€…æ˜¯ä»£å¸çš„æ‰€æœ‰è€…ã€‚æ¯æ¬¡æ•°æ®æ›´æ–°æ—¶éƒ½ä¼šå‘å‡ºä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­å‘å‡ºå…ˆå‰å’Œæ–°å€¼ã€‚

## åŠ¨æœº

è¯¥ææ¡ˆæ—¨åœ¨å¯¹å…·æœ‰åŠ¨æ€æ•°æ®çš„ä»£å¸è¿›è¡Œæ ‡å‡†åŒ–ã€‚ä¸ xDAI æˆ– Plasma é“¾ç­‰ä¾§é“¾çš„æ¡¥æ¥äº¤äº’å°†å—ç›Šäºä½¿ç”¨æ­¤ç±»ä»£å¸çš„èƒ½åŠ›ã€‚åŸºäºæ•°æ®ä»£å¸æ„å»ºçš„åè®®ï¼Œå¦‚ [åˆ†å¸ƒå¼ç¹æ®–](https://ethresear.ch/t/a-distributed-breeding-function/5264) å°†å¾—åˆ°æ”¯æŒã€‚

## è§„èŒƒ

å»ºè®®æ‰©å±• [ERC-721](./eip-721.md) æ¥å£ï¼Œå¢åŠ ä»¥ä¸‹å‡½æ•°å’Œäº‹ä»¶ï¼š

``` solidity
pragma solidity ^0.5.2;

/**
 * @dev Interface of the ERC1948 contract.
 */
interface IERC1948 {

  /**
   * @dev Emitted when `oldData` is replaced with `newData` in storage of `tokenId`.
   *
   * Note that `oldData` or `newData` may be empty bytes.
   */
  event DataUpdated(uint256 indexed tokenId, bytes32 oldData, bytes32 newData);

  /**
   * @dev Reads the data of a specified token. Returns the current data in
   * storage of `tokenId`.
   *
   * @param tokenId The token to read the data off.
   *
   * @return A bytes32 representing the current data stored in the token.
   */
  function readData(uint256 tokenId) external view returns (bytes32);

  /**
   * @dev Updates the data of a specified token. Writes `newData` into storage
   * of `tokenId`.
   *
   * @param tokenId The token to write data to.
   * @param newData The data to be written to the token.
   *
   * Emits a `DataUpdated` event.
   */
  function writeData(uint256 tokenId, bytes32 newData) external;

}
```

## ç†ç”±

NFT ä¸­å»ºè®®çš„æ•°æ®å­—æ®µç”¨äºç›´æ¥å­˜å‚¨æ•°æ®ï¼Œä¾‹å¦‚è®¡æ•°å™¨æˆ–åœ°å€ã€‚å¦‚æœéœ€è¦æ›´å¤šæ•°æ®ï¼Œå®æ–½è€…åº”å›é€€åˆ°ç»è¿‡è®¤è¯çš„æ•°æ®ç»“æ„ï¼Œå¦‚é»˜å…‹å°”æ ‘æˆ–å¸•ç‰¹é‡Œå¤æ ‘ã€‚

è¯¥ ERC çš„ææ¡ˆæºäº [åˆ†å¸ƒå¼ç¹æ®–ææ¡ˆ](https://ethresear.ch/t/a-distributed-breeding-function/5264)ï¼Œä»¥ä¾¿æ›´å¥½åœ°é›†æˆè·¨ä¾§é“¾çš„ NFTã€‚[ost.com](https://ost.com/)ã€[Skale](https://skalelabs.com/)ã€[POA](https://poa.network/) å’Œ [LeapDAO](https://leapdao.org/) å‚ä¸äº†è®¨è®ºã€‚

## å‘åå…¼å®¹æ€§

ğŸ¤·â€â™‚ï¸ ä½œè€…æœªçŸ¥é“ç›¸å…³ææ¡ˆï¼Œå› æ­¤æ— éœ€è€ƒè™‘å‘åå…¼å®¹æ€§ã€‚

## æµ‹è¯•ç”¨ä¾‹

ç®€å•çš„å¿«ä¹æµ‹è¯•ï¼š

``` javascript
const ERC1948 = artifacts.require('./ERC1948.sol');

contract('ERC1948', (accounts) => {
  const firstTokenId = 100;
  const empty = '0x0000000000000000000000000000000000000000000000000000000000000000';
  const data = '0x0101010101010101010101010101010101010101010101010101010101010101';
  let dataToken;

  beforeEach(async () => {
    dataToken = await ERC1948.new();
    await dataToken.mint(accounts[0], firstTokenId);
  });

  it('should allow to write and read', async () => {
    let rsp = await dataToken.readData(firstTokenId);
    assert.equal(rsp, empty);
    await dataToken.writeData(firstTokenId, data);
    rsp = await dataToken.readData(firstTokenId);
    assert.equal(rsp, data);
  });

});
```

## å®ç°

åœ¨ Solidity ä¸­æ¥å£çš„ç¤ºä¾‹å®ç°å¦‚ä¸‹ï¼š

``` solidity
/**
 * @dev Implementation of ERC721 token and the `IERC1948` interface.
 *
 * ERC1948 is a non-fungible token (NFT) extended with the ability to store
 * dynamic data. The data is a bytes32 field for each tokenId. If 32 bytes
 * do not suffice to store the data, an authenticated data structure (hash or
 * merkle tree) shall be used.
 */
contract ERC1948 is IERC1948, ERC721 {

  mapping(uint256 => bytes32) data;

  /**
   * @dev See `IERC1948.readData`.
   *
   * Requirements:
   *
   * - `tokenId` needs to exist.
   */
  function readData(uint256 tokenId) external view returns (bytes32) {
    require(_exists(tokenId));
    return data[tokenId];
  }

  /**
   * @dev See `IERC1948.writeData`.
   *
   * Requirements:
   *
   * - `msg.sender` needs to be owner of `tokenId`.
   */
  function writeData(uint256 tokenId, bytes32 newData) external {
    require(msg.sender == ownerOf(tokenId));
    emit DataUpdated(tokenId, data[tokenId], newData);
    data[tokenId] = newData;
  }

}
```

## ç‰ˆæƒ
ç‰ˆæƒåŠç›¸å…³æƒåˆ©é€šè¿‡ [CC0](../LICENSE.md) æ”¾å¼ƒã€‚