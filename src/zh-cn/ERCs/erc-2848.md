---
eip: 2848
title: 我自己的消息 (MOM)
author: Giuseppe Bertone (@Neurone)
discussions-to: https://github.com/InternetOfPeers/EIPs/issues/1
status: 停滞
type: 标准跟踪
category: ERC
created: 2020-08-02
---

## 简单总结

我自己的消息 (MOM) 是一个标准，用于创建您自己的公共、始终更新、不可阻止、可验证的留言板。

## 摘要

我自己的消息 (MOM) 使用以太坊作为命令和消息的多哈希的认证层。它不使用智能合约，而是使用附带特定有效载荷的简单自发送交易。

要获取更多见解，您可以测试一个 [实时客户端](http://internetofpeers.org/mom-client/)，观看 [完整的视频概述和演示](https://www.youtube.com/watch?v=z1SnoQkQYkU) 并阅读 [简要介绍](../assets/eip-2848/presentation.pdf)。

## 动机

作为一个 *开发者* 或 *池的拥有者*，我希望以去中心化的方式向我的用户发送消息。他们必须能够轻松验证我在智能合约上下文中的角色（拥有者、用户等），并且他们必须能够在不依赖外部、不安全和可被黑客攻击的社交媒体网站（如 Facebook、Twitter 等）的情况下做到这一点。此外，我希望以同样安全和可验证的方式阅读我的用户群的消息。

作为一个 *用户*，我想要一种方法来轻松分享我的想法和创意，发布内容，发送消息，接收反馈，接受建议等，而不需要处理任何复杂性：只需写一条消息，发送即可。此外，我希望能够写信给某个智能合约的拥有者或某个交易的发送者。

作为一个 *探索服务*，我希望为我的用户提供一种有效的方式来阅读智能合约拥有者的信息，并提供一个分享想法和信息的地方，而不使用第三方服务（例如 Etherscan 使用 Disqus 等）。

在 *任何角色* 中，我希望有一种方法不允许诈骗 - 没有价值的交易，没有智能合约地址需要记住或伪造 - 并且不允许垃圾邮件 - 费用低但不是免费的，即使您可以链接/引用其他帐户，您也不能直接向他们发送消息，其他人必须明确关注并监听您的交易才能阅读您的消息。

主要优点：

- 您可以向您的 ÐApp 或智能合约的用户发送消息，他们始终知道这是一种可靠的声音，因为智能合约是可靠的。
- 创建一个专门用于您个人消息的以太坊账户，只需说一次，它可以在每个社交平台上看到（不再需要在 Reddit、Twitter、Facebook、Medium、Disqus 等数十个网站上回复相同的帖子/观点）。
- 小额费用即可免费：只需支付几美分来公证您的消息，并通过 IPFS、Swarm 或您喜欢的任何其他存储进行分发。由于内容的多哈希已被公证，您可以随时检查从集中存储服务下载的消息的完整性。
- 最后，您可以直接在您的钱包中请求并获得对您言论的建议。

我知道，我自己的消息 (MOM) 听起来像 *mom*。没错，确实有双关的意思 :)

## 规范

本文档中的关键字 "MUST"、"MUST NOT"、"REQUIRED"、"SHALL"、"SHALL NOT"、"SHOULD"、"SHOULD NOT"、"RECOMMENDED"、"MAY" 和 "OPTIONAL" 在出现时应按 [RFC 2119](https://www.ietf.org/rfc/rfc2119.txt) 中的描述进行解释。

遵循 MOM 标准的客户端 **MUST** 允许用户发送和读取 MOM 交易，为每个用户感兴趣的地址创建一个 *更新的消息列表*。

在读取 MOM 交易时，MOM 客户端 **MUST** 能够显示当前和更新的消息列表，并且 **SHOULD** 能够在用户请求时显示所有消息历史。

除了消息列表，MOM 客户端 **SHOULD** 能够下载消息的内容并向用户显示。

客户端 **SHOULD** 允许用户选择和设置下载内容的来源，并且 **SHOULD** 能够使用常见的内容可寻址网络 - 即 IPFS 或 Swarm - 或 HTTP 服务器。如果内容是从 HTTP 服务器下载的，客户端 **MUST** 检查内容与声明的多哈希是否一致。

作为默认设置，客户端 **MUST** 将 `text/markdown` ([RFC 7763](https://www.ietf.org/rfc/rfc7763.txt)) 视为由多哈希表示的内容的媒体类型，特别是 [Markdown](https://en.wikipedia.org/wiki/Markdown) 文本采用 [UTF-8](https://en.wikipedia.org/wiki/UTF-8) 编码且不带 [BOM](https://en.wikipedia.org/wiki/Byte_order_mark)。

客户端 **MAY** 允许用户选择解析消息时考虑其他内容类型。在这种情况下，**SHOULD** 向用户发出警告，说明在处理消息时使用了 `text/markdown` 以外的内容类型。

**RECOMMENDED** 客户端应告知用户默认内容类型的实际设置。

### MOM 交易

客户端 **MUST** 假设 **无效的 MOM 交易不存在**。如果交易不严格遵循 MOM 标准，客户端 **MUST** 忽略它，并且 **MUST NOT** 将其视为 MOM 交易。

由于解析用户发送的数据可能存在安全隐患，客户端 **SHOULD NOT** 尝试跟踪或解释交易为 *无效* 的 MOM 交易。

#### 有效 MOM 交易的数据结构

| 属性 | 值 |
|:--------|:------------|
| `to` | **MUST** 与签署交易的账户相同。 |
| `value` |  **MUST** 为 `0` wei。 |
| `data` | **MUST** 至少为 `2` 字节。第一个字节 **MUST** 为操作码，后续字节 **MUST** 基于下面列出的操作码。 |

#### 支持的操作和消息列表

每个操作码都有一个或多个参数，所有参数 **MUST** 被视为强制性的。

可选参数不存在：如果特定操作码的参数不全或不符合规则，客户端 **MUST** 完全忽略该交易。

消息 **MUST** 始终通过其内容的多哈希进行引用。

操作分为两组：**核心** 和 **扩展** 操作。

- 客户端 **MUST** 支持所有核心操作，并且 **SHOULD** 尽可能支持更多扩展操作。
- 客户端 **SHOULD** 支持并实现尽可能多的扩展操作，但 **MAY** 选择仅实现他们感兴趣的某些特定扩展操作。

#### 核心操作

| 操作 | 代码 | 参数 | 意义 | 效果 |
|-----------|:--------:|------------|---------|--------|
| 添加 | `0x00` | 多哈希 | 添加一条消息。参数 **MUST** 为消息的多哈希。 | 客户端 **MUST** 将消息添加到发送者的消息列表中。 |
| 更新 | `0x01` | 多哈希, 多哈希 | 更新一条消息。第一个参数 **MUST** 为要更新的消息的多哈希。第二个参数 **MUST** 为更新后的消息的多哈希。 | 客户端 **MUST** 更新消息列表以显示更新后的消息。 |
| 回复 | `0x02` | 多哈希, 多哈希 | 回复一条消息。第一个参数 **MUST** 为要回复的消息的多哈希。第二个参数 **MUST** 为消息的多哈希。 | 客户端 **MUST** 在消息列表中插入一条新消息，并且 **MUST** 保留与引用消息的关系。 |
| 删除 | `0x03` | 多哈希 | 删除一条消息。参数 **MUST** 为要删除的消息的多哈希。 | 客户端 **MUST** 从消息列表中移除该消息。 |
| 关闭账户 | `0xFD` | 多哈希 | 关闭一个账户。参数 **MUST** 为包含关闭账户原因的消息的多哈希。 | 客户端 **MUST** 将包含原因的消息添加到消息列表中，并且 **MUST NOT** 将该地址发送的 MOM 消息视为有效。换句话说，MOM 客户端 **MUST** 在创建消息列表时忽略该地址发送的任何其他交易。这在用户想要更改账户时非常有用，例如因为私钥似乎被泄露。 |
| 原始 | `0xFF` | 任何 | 参数 **MUST** 至少为 `1` 字节。内容类型不公开，且 **MUST NOT** 被视为 `text/markdown`。 | 客户端 **MUST** 将消息添加到消息列表中，但 **MUST NOT** 尝试解码内容。客户端 **SHOULD** 仅在明确请求时允许用户查看此消息。此操作可用于 *盲* 公证，普通客户端可以忽略。 |
#### 关于 `DELETE` 操作代码的说明

请注意，发送 `DELETE` 命令的用户并不是在请求实际从区块链中删除任何内容，他们只是要求客户端隐藏该特定消息，因为出于某些原因它不再有效。你可以把它想象成用户在说：*我改变主意了，请不要再显示这个了*。如上文规格所述，客户端 **必须** 遵循作者的请求，除非用户明确要求另行处理。

请注意，由于通常由消息的作者确保内容对所有人可用，如果发送了 `DELETE` 消息，那么引用的多哈希内容很可能不再可用，因为可能没有人共享它。

#### 扩展操作

| 操作 | 代码 | 参数 | 意义 | 效果 |
|-----------|:--------:|------------|---------|--------|
| 添加 & 引用 | `0x04` | 多哈希, 地址 | 添加一条消息并引用一个账户。第一个参数 **必须** 是消息的多哈希。第二个参数 **必须** 是消息引用的地址。 | 客户端 **必须** 将消息添加到消息列表中，并 **必须** 跟踪对指定账户的引用。这可以用于*邀请*引用账户的所有者阅读这条特定消息。 |
| 更新 & 引用 | `0x05` | 多哈希, 多哈希, 地址 | 更新一条消息。第一个参数 **必须** 是要更新的消息的多哈希。第二个参数 **必须** 是更新后消息的多哈希。第三个参数 **必须** 是消息引用的地址。 | 客户端 **必须** 更新消息列表以显示更新后的消息，并 **必须** 跟踪对指定账户的引用。这可以用于*邀请*引用账户的所有者阅读这条特定消息。 |
| 认可 | `0x06` | 多哈希 | 认可由指定多哈希标识的消息。参数 **必须** 是要认可的消息的多哈希。 | 客户端 **必须** 记录并跟踪该特定消息的认可。可以将其视为*点赞*、*转发*等。 |
| 移除认可 | `0x07` | 多哈希 | 移除对由指定多哈希标识的消息的认可。参数 **必须** 是消息的多哈希。 | 客户端 **必须** 移除该特定消息的认可。 |
| 不赞成 | `0x08` | 多哈希 | 不赞成由指定多哈希标识的消息。参数 **必须** 是要不赞成的消息的多哈希。 | 客户端 **必须** 记录并跟踪该特定消息的不赞成。可以将其视为*我不喜欢它*。 |
| 移除不赞成 | `0x09` | 多哈希 | 移除对由指定多哈希标识的消息的不赞成。参数 **必须** 是消息的多哈希。 | 客户端 **必须** 移除该特定消息的不赞成。 |
| 认可 & 回复 | `0x0A` | 多哈希, 多哈希 | 认可一条消息并回复它。第一个参数 **必须** 是要回复的消息的多哈希。第二个参数 **必须** 是消息的多哈希。 | 客户端 **必须** 在消息列表中插入一条新消息，并 **必须** 保留与引用消息的关系。客户端 **必须** 还记录并跟踪该特定消息的认可。 |
| 不赞成 & 回复 | `0x0B` | 多哈希, 多哈希 | 不赞成一条消息并回复它。第一个参数 **必须** 是要回复的消息的多哈希。第二个参数 **必须** 是消息的多哈希。 | 客户端 **必须** 在消息列表中插入一条新消息，并 **必须** 保留与引用消息的关系。客户端 **必须** 还记录并跟踪该特定消息的不赞成。 |

## 理由

以太坊是*基于账户*的，因此作为单一信息源进行识别是好的。

它也能够很好地进行公证，并对交易结构施加一些限制，因此适合用于命令。

IPFS、Swarm 或其他内容可寻址网络（CANs）或存储方法适合存储大量信息。因此，两个世界的结合是实现此消息标准目标的良好解决方案。

目标也是首先避免任何类型的欺诈和恶意行为，因此 MOM 不允许向其他账户发送交易，MOM 交易的价值始终为 0。

### 为什么不使用智能合约？

MOM 希望实用、易于实现和阅读、无错误、快速且便宜，但：

- 使用智能合约进行消息处理更容易导致错误和误解：
  - 合约地址可能错误
  - 智能合约必须在特定网络上部署才能发送消息
- 执行智能合约的成本远高于发送交易的成本
- 仅仅为了存储静态数据而执行智能合约是反模式的最佳示例（昂贵且几乎无用）

没有特定的智能合约可依赖，MOM 标准可以立即在任何现有网络中实现和使用，甚至在未来的网络中。

最后，如果你可以在没有智能合约的情况下实现完全相同的结果，那么你一开始就不需要智能合约。

### 为什么不直接在链上存储消息？

如果静态消息与某些智能合约的状态无关，或者不代表价值交换，则在链上存储静态消息没有好处。存储数据在链上的成本也非常高。

### 为什么不在消息中存储操作码？

虽然成本效益是区块链相关标准中的一个非常重要的特性，但在可用性和实用性之间也需要达到妥协。

在消息中存储命令迫使客户端实际下载消息以理解该如何处理它们。这是非常低效的，浪费带宽和时间。

能够在下载内容之前查看命令，使客户端能够重建所有消息的历史，然后最终仅下载更新的消息。

为消息内容创建结构会导致许多问题和解析内容时的考虑，包括内容是否正确、拼写错误等。

最后，**内容必须保持干净**。你确实想要公证内容，而不是引用数据结构，因为这可能在检查内容是否与其他内容相同时导致可能的假阴性。

### 为什么使用多哈希？

[多哈希](https://github.com/multiformats/multihash) 是灵活的、面向未来的，并且已经有大量库支持它。以太坊必须能够与许多不同的平台和架构轻松集成，因此 MOM 标准遵循这一理念。

## 向后兼容性

你可以在以太坊网络上找到一些使用与此 EIP 类似模式的交易。有时这是为了使内存池中的先前交易无效，使用相同的 nonce 但更高的 gas 价格，以便该交易被挖掘并取消仍在内存池中的先前交易。如果在批准此 EIP 之前创建，则可以轻松忽略此类交易，或者只需检查有效负载是否遵循正确的语法。

## 测试用例

可以在 [GitHub](https://github.com/InternetOfPeers/mom-client) 上找到并测试符合 MOM 标准的客户端。
您可以通过 [GitHub Pages](https://internetofpeers.github.io/mom-client) 或通过 IPFS 直接使用最新版本的 MOM 客户端（请参阅 [client repo](https://github.com/InternetOfPeers/mom-client) 获取最新更新地址）。

## 实现

您可以在 [GitHub Packages](https://github.com/InternetOfPeers/mom-js/packages/323930) 或 [npmjs](https://www.npmjs.com/package/@internetofpeers/mom-js) 上使用已经工作的 MOM JavaScript 包。该包已被上述 MOM 客户端使用，您也可以在您的 ÐApps 中使用它：

```bash
npm install @internetofpeers/mom-js
```

交易 [`0x8e49485c56897757a6f2707b92cd5dad06126afed92261b9fe1a19b110bc34e6`](https://etherscan.io/tx/0x8e49485c56897757a6f2707b92cd5dad06126afed92261b9fe1a19b110bc34e6) 是一个已经在主网挖掘的有效 MOM 交易示例；它是一个 `ADD` 消息。

## 安全考虑

MOM 非常简单，且本身没有真正的安全隐患。标准仅考虑值为 `0` 且 `from` 和 `to` 地址相等的交易为有效。

唯一的担忧可能来自有效负载，但这更多与客户端相关，而不是标准本身，因此在这里您可以找到一些与实现标准的客户端相关的安全建议。

### 解析命令

MOM 标准涉及解析由潜在恶意客户端生成的有效负载，因此必须注意避免不必要的代码执行。

- 严格遵循标准代码
- 除非用户明确确认，否则不要执行任何标准之外的命令
- 忽略格式错误的交易（不严格遵循规则的交易）

### 消息

遵循 MOM 标准的消息的默认内容类型是 UTF8 编码的 Markdown 文本，不带 BOM。强烈建议禁止读取任何非文本内容类型，除非用户明确确认。

由于内容多哈希始终存储在链中，客户端可以从内容可寻址网络（如 IPFS 或 Swarm）或中央服务器下载该内容。在后者的情况下，客户端应始终检查接收消息的完整性，或者如果无法做到这一点，则必须警告用户（功能未实现或出错）。

## 版权

版权及相关权利通过 [CC0](../LICENSE.md) 放弃。